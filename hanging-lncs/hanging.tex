% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.21 of 2022/01/12
%
\documentclass[runningheads]{llncs}
%
\newcommand{\False}{\type{False}}
\newcommand{\True}{\type{True}}
\usepackage{changepage}
\usepackage{hyperref}
\newenvironment{myindent}{\begin{adjustwidth}{1cm}{}}{\end{adjustwidth}}

\usepackage{listings}
\usepackage{lipsum}
\usepackage{courier}
\usepackage{color}
\lstset{basicstyle=\footnotesize\ttfamily,breaklines=true}
\lstset{frame=single}


\usepackage[T1]{fontenc}
% T1 fonts will be used to generate the final print and online PDFs,
% so please use T1 fonts in your manuscript whenever possible.
% Other font encondings may result in incorrect characters.
%
\usepackage{graphicx}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following two lines
% to display URLs in blue roman font according to Springer's eBook style:
%\usepackage{color}
%\renewcommand\UrlFont{\color{blue}\rmfamily}
%
\begin{document}
%
\title{Formalizing the Unexpected Hanging Paradox in Coq : a New Surprise Definition} %\thanks{Supported by organization x.}}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Polina Vinogradova\inst{1}\orcidID{0000-0003-3271-3841} }
% \and
% Second Author\inst{2,3}\orcidID{1111-2222-3333-4444} \and
% Third Author\inst{3}\orcidID{2222--3333-4444-5555}}
%
\authorrunning{Polina Vinogradova}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{IOG
\email{polina.vinogradova@iohk.io}}
%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}

  In this work we define a novel approach to formally specifying the
  unexpected hanging paradox, sometimes called the surprise examination paradox, using a
  constructive logical framework in the
  Coq proof assistant. This paradox requires the formalization of the notion of
  a \emph{surprise} event, which, for the purposes of this paradox, is usually interpreted as
  the inability to predict what day a specific event takes place. As in existing work,
  the use of constructive logic allows us to represent knowledge as provability.
  We make the observation that an inevitable event requires there being strictly
  more than one possible day on which it can occur, and define surprise accordingly. We
  specify constraints of the paradox representing this surprise definition.
  We present a predicate that, in accordance with the paradox constraints, constructs a
  proposition we can use to reason about
  the provability of the hanging on a specific day, given that today is a particular day of the week, and the hanging
  is planned for yet another day.
  We assert that this offers a satisfying resolution to the paradox in accordance with
  our intuition.
  We also provide a comparison to a weaker interpretation of surprise, 
  and an analysis of how it interplays with the use of constructive logic, and
  compare it to our definition.

\keywords{surprise examination \and paradox \and unexpected hanging \and Coq \and constructive logic.}
\end{abstract}
%




\section{Introduction}

The unexpected hanging paradox, also known as the surprise examination paradox,
is a logical paradox introduced in the the Mind philosophical journal in 1948 \cite{original},
and popularized by the Scientific American Mathematical
Games column author Martin Gardner, discussed in his work \cite{diversions}.
It describes the notion of a future event that
is both certain, and not possible to predict the exact day of occurrence of,
formulated as follows :

\begin{myindent}
  A judge tells a condemned prisoner that he will be hanged at noon on one weekday
  in the following week but that the execution will be a surprise to the prisoner.
  He will not know the day of the hanging until the executioner knocks on his cell door at noon that day.

  Having reflected on his sentence, the prisoner draws the conclusion that he will
  escape from the hanging. His reasoning is in several parts. He begins by concluding
  that the "surprise hanging" can't be on Friday, as if he hasn't been hanged by
  Thursday, there is only one day left – and so it won't be a surprise if he's hanged on
  Friday. Since the judge's sentence stipulated that the hanging would be a surprise
  to him, he concludes it cannot occur on Friday.

  He then reasons that the surprise hanging cannot be on Thursday either, because
  Friday has already been eliminated and if he hasn't been hanged by Wednesday noon,
  the hanging must occur on Thursday, making a Thursday hanging not a surprise either.
  By similar reasoning, he concludes that the hanging can also not occur on Wednesday,
  Tuesday or Monday. Joyfully he retires to his cell confident that the hanging will
  not occur at all.

  The next week, the executioner knocks on the prisoner's door at noon on Wednesday –
  which, despite all the above, was an utter surprise to him. Everything the judge said came true.
\end{myindent}

Existing formalization efforts attempt to address questions like "how can we formally
define surprise?", "where is the flaw in the
reasoning of the prisoner?" and "was it contradictory for the prisoner to have been
hanged on Wednesday?". There is work on tackling these questions in multiple
different branches of philosophy and mathematics.
An an extensive review of the existing approaches is given in \cite{extensivereview}.

The definition of surprise as the inability to deduce beforehand the date of the test
was first introduced in \cite{prediction}. A statistical approach to the problem
of prediction in this context is discussed in \cite{statistical}.
A proposed solution in the field of epistemology with the use of modal
logic, is presented in \cite{modalepistemic}. An approach involving
Kripke semantics, employing the notion of persuasion, is in \cite{kripkemodal}.

The use of non-classical logic,
eg., appealing to Goedel's incompleteness, was first applied to the
paradox in \cite{goedelized}, then in \cite{godelinconsistent}, and most recently
in \cite{constructive} \cite{nonpredet}. The latter two works assume the underlying logic to itself be
constructive, as compared to reasoning via the provability operator $\mathsf{Pr}$ to indicate
a possibly non-classical statement. This approach aligns most closely with ours.
However, in this work we do not analyze the paradox from the point of view of
what we can conclude from inconsistency of our system.

The work \cite{fourpossible} investigates the relation between the conclusions
of the non-classical logic approaches and those from epistemology, as well
as presenting four distinct approaches to formalizing the paradox, from which
we take inspiration for this work.

In this work, we take the point of view that the constraints of the paradox are
fixed and correctly conveyed to the prisoner.
Like previous works cited, we chose to represent
\emph{knowledge} as constructive propositions, leaving room for uncertainty, or possibility, by
dropping the law of excluded middle.

A distinction between existing work and our formalization is that
we do not use modal or temporal logic (which is the approach in \cite{modalepistemic}).
Instead, we take advantage of the expressivity of the dependently typed logic of Coq directly to
achieve the formalization of the paradox constraints at different points in the week,
and parametrized by a different day on which the hanging actually happens.

Because constructive logical is notoriously slippery, we chose to use a proof
assistant (Coq, see \cite{coqmanual}) to take a closer, more high-assurance look at the
interplay between the seemingly simple conditions of this conundrum.
There is precedent for the use of proof assistants to tackle philosophical
investigation, with the most striking and recent example
being a refinement of Kant's categorical imperative \cite{categoricalkant}.

  The contributions of this paper are as follows :

  \begin{itemize}
    \item[(i)] A novel definition (in Coq) of surprise that we propose,
    Section \ref{sec:lack}, which reflects
    the following natural language statement : "a hanging has not occurred on or before a given day,
    and there exist at least two distinct future days on which a hanging
    is possible". We
    also give an analysis of how this definition aligns with our intuition;

    \item[(ii)] The definition of constraints on the prisoner's situation at each
    point in the week, which specifies the conditions of the paradox and makes use
    of the surprise definition we propose, Section \ref{sec:constraints}. We also
    give a formal proof of the impossibility of being surprised by a Friday hanging
    on Thursday, according to our definition;

    \item[(v)] The construction of a three-parameter predicate returning a proposition about
    whether on not a hanging happens on \emph{a given day}, given that we know whether or not a hanging
    happened on days up and including the parameter day \emph{today}, and a day on which the hanging
    actually happens, see Section \ref{sec:predicate}, along with a proof that the reasoning specified by
    this proposition is in accordance with our surprise specification;

    \item[(iv)] An alternate, weaker formalization of surprise (Section \ref{sec:one}). We give analysis of how
    our definition compares to this one, and why it gives us insufficient reasoning
    power in the case that the surprise reasoning predicate is non-classical, but
    in the case that it is classical, allows us to reason ourselves out of the hanging entirely by concluding
    a sure-thing Friday hanging on Thursday.
  \end{itemize}

  For our code, see \url{https://github.com/polinavino/unexpected_hanging/blob/master/unexpected_hanging.v}.

\section{Coq and the Paradox}
\label{sec:form}

Coq is a proof assistant that offers a dependently typed formal language.
It is capable of verifying formal user-defined proofs of propositions, as well as has support
for automation of certain kinds of proofs. The choice of Coq, as opposed to another
proof assistant such as Agda, was based largely on the authors' familiarity with the system,
as any dependently typed proof verifier that supports constructive logic
would serve just as well for the purposes of this formalization.

To formalize the paradox, we need to reason about days of the week on which
the paradox could happen, so we
begin by constructing a type {\tt weekDay} the terms of which are week days :

\begin{lstlisting}
  Inductive weekDay : Type :=
    | monday : weekDay | ... | friday : weekDay.
\end{lstlisting}

We also define a type {\tt weekAndBefore}, which represents all the weekdays in
the type above, plus the Sunday that comes before --- the purpose of this type is to
represent all the days on which one can consider the possibility of surprise,
differentiating it from the subset of days on which the hanging can occur. We
also define comparison function {\tt <}, which computes
whether a given {\tt td} is before {\tt d},
following real-life weekday logic, eg. Sunday is before Monday.

It is important to emphasize here that $=,~\geq,~<$ are all \emph{decidable}
comparison functions on days --- purely as a consequence of considering weekdays
as totally, decidably ordered numbers, even in constructive logic. Any predicates
formulated solely out of those comparisons together with logical connectives are also decidable,
with the implication that provability, knowledge, and truth are the same for such predicates,
leaving no room for uncertainty.
For this reason, solutions of the paradox constructed out of only such decidable predicates (eg. \cite{godelinconsistent})
are operating in classical logic.

Next, we can specify the type of a
function that, given a day of the week, returns $\mathsf{True}$ if we can prove the hanging
happened then, and $\mathsf{False}$ if we can prove it did not. We reason about this function
in the presence of preconditions that are formal interpretations of those described
in the paradox. We leave this function as a variable :

\begin{lstlisting}[mathescape=true]
  Variable hangingOnDay : weekDay $\to$ Prop.
\end{lstlisting}

We discuss the existence of such a predicate, and how it changes depending
on what day today is, and when a hanging actually happens, in \ref{sec:predicate}.
Next, we define a predicate that formalizes the notion that no hanging has occurred
yet (up to and including the parameter day {\tt td}, representing \emph{today}) :

\begin{lstlisting}[mathescape=true]
  Definition noHangingYet (td : weekAndBefore) :=
    $\forall$ d, td $\geq$ d $\to$ $\neg $ hangingOnDay d.
\end{lstlisting}

This says that for any day {\tt d}, if it is before today {\tt td}, no hanging
happened on {\tt d}.
We use the double negation {\tt $\neg \neg$ hangingOnDay d} to formalize the statement that it is
not possible to disprove that a hanging occurs on day {\tt d}. That is, a hanging
is \emph{possible} on a given day.

\section{Uniqueness of hanging. }
\label{sec:unique}

Uniqueness of the hanging day plays an important role in the definition of surprise.
We define the predicate {\tt uniqueHanging} formalizing that after a given day {\tt td},
there can be at most one day on which a hanging occurs. So,
{\tt uniqueHanging dayBefore} states this about the entire week.

\begin{lstlisting}[mathescape=true]
  Definition uniqueHanging (td : weekAndBefore) :=
    $\forall$ d d', td $<$ d $\wedge$ td $<$ d' $\to$
    hangingOnDay d $\to$ hangingOnDay d' $\to$ d = d'.
\end{lstlisting}

The constraint, {\tt uniqueHanging}, that
a (provable) hanging day is unique is, in fact, equivalent to the constraint
that a (possible) hanging day is unique. Moreover, negation of uniqueness
is implied by a stronger statement ({\tt twoPossible}), which explicitly
requires the presence of at least two possibilities for the hanging date.
Note here also that this reasoning does not rely on any additional knowledge about
the hanging predicate.

\begin{lstlisting}[mathescape=true]
  Definition uniqueMaybe (td : weekAndBefore) :=
    $\forall$ d d',
    td $<$ d $\wedge$ td $<$ d' $\to$
    $\neg~\neg$ hangingOnDay d $\to$
    $\neg~\neg$ hangingOnDay d' $\to$
    d = d'.

  Lemma uniqueMaybeEqv (td : weekAndBefore) :
    uniqueHanging td $\leftrightarrow$ uniqueMaybe td.

  Definition twoPossible (td : weekAndBefore) :=
    $\exists$ d d', td $<$ d $\wedge$ td $<$ d' $\wedge$ d $\neq$ d'
    $\wedge$ $\neg \neg$ hangingOnDay d $\wedge$ $\neg \neg$ hangingOnDay d'.

  Lemma twoNotUnique : $\forall$ td,
    twoPossible td $\to$ $\neg$ uniqueHanging td.
\end{lstlisting}

We make an observations about this : a future hanging is
necessarily not unique. This seems wrong --- we would expect a hanging to be
unique, it's implicit in the description of the paradox. However, we define
surprise in part as a non-uniqueness of a future hanging.

\section{A lack of surprise}
\label{sec:lack}

Surprise is difficult to define, so we try to define, instead, what it means to be certain about
when a hanging happens, given a collection of days on which it can happen.
We define what it means for us to know that a hanging happened before today {\tt td},

\begin{lstlisting}[mathescape=true]
  Definition knowHanging (td : weekAndBefore) :=
    ($\exists$ d, td $\geq$ d $\wedge$ hangingOnDay d) $\wedge$ (uniqueHanging dayBefore).
\end{lstlisting}

For this predicate to be true, the function {\tt hangingOnDay} must be provably $\leftrightarrow$ {\tt True}
for exactly one day {\tt d} of the entire week, {\tt False} for all other weekdays, and this day {\tt d} is
before or on {\tt td}.
This predicate {\tt knowHanging} should hold exactly when a hanging has already happened
before today.

Now, let us consider the negation of these two conditions for days {\tt d} after {\tt td} :

\begin{lstlisting}[mathescape=true]
  Definition dontKnowHanging (td : weekAndBefore) :=
    $\neg$ (($\exists$ d, td $<$ d $\wedge$ hangingOnDay d)
      $\wedge$ (uniqueHanging dayBefore)).
\end{lstlisting}

So, either there is no hanging, or it is not unique. This represents surprise fairly
well, however, it allows for the possibility that no hanging happens at all in the
rest of the week, which should only be true if one had occurred before {\tt td}.
So, we must add to this definition a constraint that if we are able to prove that no
hanging happens this week, we have proven {\tt False} (we will handle the case for when
a hanging did happen already separately).

Note here that while we want to say that on each future day, proving a hanging
occurrence should not be possible, adding this to our definition will allow us to
prove that no hanging happens at all --- and we want the opposite of that.
That is, the proposition that no hanging happens the entire week implies that no
hanging is even possible, as {\tt $\neg$ hangingOnDay d $\to$ $\neg$ ($\neg~\neg$ hangingOnDay d)}.
We notice that the both {\tt uniqueHanging td} and its negation are trivially
satisfied whenever {\tt $\neg$ ($\exists$ d, td $<$ d $\wedge$ hangingOnDay d)}. For this
reason we use the stronger {\tt twoPossible td} in our definition of surprise,
which contradicts the possibility of there not being a hanging at all, and
guarantees two possible days.

So, regardless of when the hanging actually happens, we define what it means
for surprise to being possible after {\tt td} as,

\begin{lstlisting}[mathescape=true]
  Definition surprise (td : weekAndBefore) :=
    (noHangingYet td) $\wedge$ (twoPossible td).
\end{lstlisting}

\section{The hanging predicate}
\label{sec:predicate}

According to the definition of the paradox, a Wednesday hanging satisfies
the constraints. However, the spirit of the paradox seems to suggest there is nothing
special about a Wednesday hanging. Here we explain how to parametrize our reasoning
by different possible hanging days. Recall that we want to reason about what sort of
function {\tt hangingOnDay} satisfies the constraints of the paradox.

We already parametrize the function {\tt surprise},
representing our inability to predict a hanging day (ie. choose a unique hanging day)
after today {\tt td}, by what day today {\tt td} is. This function, in turn, builds propositions
to reason about whether a hanging day happened on some day {\tt d} by using the
predicate {\tt hangingOnDay}. We note that this predicate must actually be a different
predicate depending on what day {\tt td} is as well, since we must vary it to
indicate that we have full knowledge of all days before today.
We require one more additional in our hanging predicate --- the
actual day of the occurrence of the hanging, which may be Wednesday or otherwise.
So, all in all, a function

{\tt hangingOnTodayIsReasoningAbout hang td d : Prop}

that we will define so that it satisfies the paradox constraints, has three parameters :

\begin{itemize}
  \item[(i)] {\tt hang : weekDay}, which is the day on which the hanging actually occurs
  (once today is or or after this day, surprise should no longer be possible, but the paradox
  conditions may not be violated)
  \item[(ii)] {\tt td : weekAndBefore}, which is the day that is "today", ie. the day
  on which the prisoner is reasoning about the hanging (all the days before and including today
  should have a classical predicate about whether a hanging occurred or not)
  \item[(iii)] {\tt d : weekDay}, the day about which the prisoner is reasoning (eg.
  tomorrow), but should not be able to prove or disprove the occurrence of a hanging on,
  unless it already happened prior to {\tt td}
\end{itemize}

Parametrizing by hanging day lets us define a set of reasoning predicates
each of which assumes a different actual day of hanging.
We reformulate the reasoning predicate to be parametrized in this way,
To accommodate this change, we also parametrize all
the predicates used in the definition, ie. {\tt noHangingYetparam hangingOn hang td}, etc.

\section{Paradox constraints}
\label{sec:constraints}

We now present the constraints to be placed by the description of the paradox on the
hanging predicate {\tt hangingOnTodayIsReasoningAbout} discussed above.

\begin{lstlisting}[mathescape=true]
  Definition twoPossiblePRDXparam
      (hangingOn : weekDay $\to$ weekAndBefore $\to$ weekDay $\to$ Prop)
      (hang : weekDay) (td : weekAndBefore) :=
    (td $\geq$ hang $\wedge$ (hangingOn hang td hang)
        $\wedge$ uniqueHangingparam (hangingOn hang td) dayBefore)
    $\vee$
    (td $<$ hang $\wedge$ noHangingYetparam td
        $\wedge$ twoPossibleparam (hangingOn hang td) td).
\end{lstlisting}

We want to define a {\tt hangingOnTodayIsReasoningAbout} such that

\begin{lstlisting}[mathescape=true]
Lemma hangingFuncOk : $\forall$ hang td,
    $\neg$ (td = (someWeekDay thursday) $\wedge$ hang = friday) $\to$
    twoPossiblePRDXparam
        (hangingOnTodayIsReasoningAbout hang td) td.
\end{lstlisting}

We explicitly exclude being surprised
on Thursday by a Friday hanging, as it appears to legitimately be a situation devoid
of surprise (see discussion below).
The statement of the paradox can be interpreted using these constraints and
the predicate definition as :

\begin{myindent}
  The executioner plans the hanging to be on the parameter
  day {\tt hang}. He tells the prisoner that a correct approach to reasoning about
  whether the hanging happens on a given day, {\tt hangingOnTodayIsReasoningAbout},
  must satisfy the constraints of the paradox, as specified by {\tt twoPossiblePRDXparam}.
\end{myindent}

We define the predicate :

\begin{lstlisting}[mathescape=true]
  Definition hangingOnTodayIsReasoningAbout hang td d : Prop :=
    (td $\geq$ hang $\to$ hang = d) $\wedge$ (td < hang $\wedge$ td > d $\to$ False)
    $\wedge$ (td < hang $\wedge$ td < d $\to$ ($\neg~\neg$ hf hang td d)).
\end{lstlisting}

which says that if today is after the day of the hanging, this is a provable predicate when the
day being reasoned about is the same as the hanging day. If today is prior to the hanging, and
we are reasoning about a day before {\tt td}, the day we reason about cannot have a hanging.
Finally, if the hanging day is not
yet reached, a hanging occurrence cannot be disproved about any future day.

Next, we observe that the value {\tt True} instead of {\tt hf hang td d} would
actually do the trick. In fact, we prove that it does by defining it that
way and proving lemma {\tt hangingFuncOk}. However, claiming that a hanging is going to happen
on all future days, and we can prove it, does not sound like a satisfying
resolution. But we argue that it may well be --- since in order for us to
"know when the hanging happens", we must prove that it happens on exactly one day.
If we prove that it happens on multiple days in the future, this does not
constitute knowledge of when the one promised hanging will happen.

We do not specify a non-classical predicate {\tt hf} as Coq does not support
straightforward definition of non-terminating functions.
We conjecture (and aspire to show as part of future work) that it is possible to
define {\tt hf} to be strictly weaker than {\tt True} for the relevant inputs,
satisfying the paradox. Such a definition would align more closely with
the intuition that all future days should have a \emph{possibility} of hanging.

The first thing we can formally conclude about this definition is that it indeed rules out
a Friday hanging. The following lemma says that it is not possible that by Thursday,
no hanging has happened, but there are still two distinct possible days on which it can
happen in the future.

\begin{lstlisting}[mathescape=true]
  Lemma cantBeSurpFriday hangingOnTodayIsReasoningAbout :
    $\forall$ hang,
    twoPossiblePRDXparam hangingOnTodayIsReasoningAbout hang
      (someWeekDay thursday)
    $\to$ noHangingYetparam hangingOnTodayIsReasoningAbout hang
      (someWeekDay thursday)
    $\to$ False.
\end{lstlisting}

The proof (see code) is simple, since there is only one day (Friday) left in the week,
and no hangings are possible on past days.
Inductive reasoning in attempt to conclude that a Thursday hanging is
predictable on Wednesday does not work because we do not have enough data on Wednesday
to conclude whether a hanging will be Thursday or Friday. That is, to discount Friday
as a possibility of surprise hanging, we \emph{need to know that there was no
hanging Thursday}.

\section{At least one possible day}.
\label{sec:one}

Surprise requires that a future hanging is possible --- on more than zero
of the remaining weekdays after today. There is precedent \cite{fourpossible}
for defining surprise
in a way that allows a Friday hanging to be a surprise in a consistent way.
We specify this interpretation of surprise, together with the other the conditions
of the paradox (ie. that once a hanging occurs, there will be no future hangings) :

\begin{lstlisting}[mathescape=true]
  Definition onePossiblePRDXparam
      (hangingOn : weekDay $\to$ weekAndBefore $\to$ weekDay $\to$ Prop)
      (hang : weekDay) (td : weekAndBefore) :=
    (td $\geq$ hang $\wedge$ (hangingOn hang td hang)
        $\wedge$ uniqueHangingparam (hangingOn hang td) dayBefore)
    $\vee$
    (td $<$ hang $\wedge$ noHangingYetparam td $\wedge$
        $\exists$ d, td $<$ d $\wedge$ $\neg~\neg~$ (hangingOn hang td) d).
\end{lstlisting}

where the first disjunct is the same as before, and
the second one corresponds to "today is not
  yet Friday, and there is a possible day on which a hanging may happen", which
  we refer to as the {\tt onePossible} definition of surprise. This is a strictly
weaker definition than {\tt twoPossiblePRDXparam}, as the last conjunct of the
disjunct requires only one possible day to exist, rather than two distinct ones.
So, the same predicate {\tt hangingOnTodayIsReasoningAbout} satisfies these
constraints as well.

No inconsistency is introduced here, in fact, the hanging can still be a surprise even if it
happens on a Friday! The intuition behind this is : if no hanging happened by
Thursday, it is still only possible to prove {\tt $\neg~\neg$~hangingOn hang td friday},
from which we are not necessarily able to deduce that {\tt hangingOn hang td friday}.
However, defining {\tt hf hang td d = True} for all future days (when there is no hanging yet)
immediately results is being able to prove a unique (future) Friday hanging when today is Thursday.

Let us consider the possible, ie. $\neg~\neg$ case, again, and
what happens if we impose an additional constraint stating that
exactly one \emph{possible} hanging
day implies that it \emph{provably happens} on a specific day. Similar reasoning is also explored in
\cite{fourpossible}, with a similar conclusion to the one we draw here. The following
proposition states that there is a possible hanging day, and that uniqueness of hanging day
possibility implies certainty of hanging on that day :

\begin{lstlisting}[mathescape=true]
  Definition existsUniqueHappens :=
    ($\exists$ d, $\neg~\neg$ hangingOnDay d)
    $\wedge$
    ($\forall$ d d', $\neg~\neg$ hangingOnDay d
      $\to$ $\neg~\neg$ hangingOnDay d' $\to$ d = d')
    $\to$ $\exists$ d, hangingOnDay d.
\end{lstlisting}

Now, the following statement expresses that {\tt existsUniqueHappens} lets us
conclude that {\tt hangingOnDay} must then be classical (the proof is in the
associated code) :

\begin{lstlisting}[mathescape=true]
  Lemma euhImpClassical :
    (uniqueHanging dayBefore) $\to$
    ($\exists$ d, $\neg~\neg~$ hangingOnDay d) $\to$
    existsUniqueHappens $\to$
    ($\forall$ d, $\neg~$ hangingOnDay d $\vee$ hangingOnDay d).
\end{lstlisting}

This is the crux of the reasoning the prisoner
engages in to informally to arrive at the judgement that
if a hanging hasn't happened by Thursday, it must happen on Friday.
Note here that the inductive reasoning in the prisoner uses to conclude that the
hanging cannot ever be a surprise is, in some sense, superfluous --- we can use
constructive logic reasoning to prove, without induction, that "if we can conclude
from existence plus uniqueness of a possible hanging day, that it is certain on that day,
\emph{our judgement about hanging occurring on any day must necessarily be classical}".
The proof makes use of the fact that the equality comparison {\tt d = d'} is
classical. This definition leaves us with the following conclusions about defining surprise as
having at least one possible hanging day :

\begin{itemize}
  \item[(i)] a definition of surprise with a non-{\tt True} {\tt hf} function
  may not be strong enough to allow us to conclude
  {\tt existsUniqueHappens}, in particular, that a hanging
  must happen Friday given that it has not occurred by Thursday, and is
  therefore not a surprise in that case ; and \newline
  \item[(ii)] if we \emph{were} to be able to conclude {\tt existsUniqueHappens},
  reasoning about surprise
  becomes classical, so we can always figure out the unique hanging day at any point in the week.
\end{itemize}

Both possibilities appear problematic : (i) does not allow us to make
a conclusion that we would like make according to intuition,
and (ii) removes any ambiguity
about the future hanging day, and therefore, the possibility of surprise.

With the two-possible definition of the paradox, surprise by Friday hanging is anyways
not possible on Thursday.
Our definition, however, does not allow us to conclude directly that a hanging will
definitely happen on Friday once we get to Thursday. Rather, it is that the
conditions for surprise are not satisfied on Thursday in another way (insufficient
possible days). An impossibility of a Friday hanging being a surprise on Thursday has no effect
on the rest of the week (as shown in \ref{sec:constraints}) in the sense that
the surprise constraints are satisfied on other combinations of days for all {\tt d}.

Note here that
the difference between one- and two-possible versions of surprise, with respect
to having proofs of future hangings, is that assuming
({\tt hf friday (someWeekDay thursday) friday = True}), rather than a only
possibility of a hanging on Friday, breaks the one-possible paradox case.
This is because the one-case, assuming the {\tt True} version of {\tt hf},
allows a unique Friday hanging to be proved on Thursday without contradiction, but
the two-case does not allow this. However, using a weaker {\tt hf} in the one-case, for which
we can only prove a hanging possibility, does not allow us to conclude that
the hanging will definitely happen on Friday even when it is the only possible day.
So, we must \emph{rely} on the reasoning in
{\tt existsUniqueHappens} to conclude surprise is not possible on Thursday,
which leads to the conclusion that the prisoner arrived at.
In the two-case, we can use the paradox definition to conclude that a Friday
hanging will not be a surprise on Thursday, and can avoid requiring this reasoning.

\section{Conclusion and Future Work}

We have presented a formalization of the constraints of the unexpected hanging paradox
parametrized by the day the hanging is planned,
together with a family of predicates (a distinct one for each day the hanging
will actually take place) that lets us reason, according to the knowledge the prisoner has,
about a hanging happening or not happening on
past and future hanging days from the perspective of each of the days of the week.
This formalization appears to capture the
conditions of the paradox and align with our intuition.
We formalized this definition, along with some related proofs, in the Coq
proof assistant, relying on the axioms of constructive logic to represent knowledge,
and the possibility of uncertainty.
A few key ideas were needed to achieve this.

First, we observe that knowing when a hanging happens requires that we are able to
reason that a hanging happens on some day of the week, and that this day is unique.
We define a lack of knowledge of when a unique hanging happens (ie. the possibility of surprise)
as the negation of this,
together with the assumption that there exists day on which a hanging is possible.
This approach to defining surprise allows us to exclude Thursday
as a day on which we can be surprised by a Friday hanging, but include all other
combinations of hanging day, today, and day about which we reason, as meeting
the paradox conditions. However, we notice that
our definition of hanging does not require us to adhere to non-classical
reasoning if all that is needed to claim uncertainty about the hanging day
is the ability to prove that it happens on multiple different days, rather than one unique one.

We compare our definition to a formalization of paradox constraints with a slightly
weaker definition of surprise. This definition requires at least one day to
exist in the future on which we cannot disprove the hanging. We notice that a classical
definition of the hanging predicate leads to the ability to prove knowledge of a
Friday hanging on Thursday, without contradiction. However, a non-classical
definition of the hanging predicate does not allow us to definitively conclude a Friday hanging
on Thursday --- only the possibility of it. Imposing this conclusion results in
the ability to prove the existence of a unique future hanging, thus contradicting
our notion of surprise.

As part of future work, we conjecture this paradox formalization could be further analyzed by way of considering its
relationship to the axiom of choice. This is due to its (at least surface level)
resemblance to the way the AC makes a connection between classical logic
and a choice function \cite{accomp} as well as arbitrary elements \cite{randomness}.

Another future direction we consider is generalizing the surprise hanging
approach we propose to using constructive logic for describing and proving
the existence of a function {\tt myPick}
which represents choosing an arbitrary value from a decidable set. In particular,
given a decidable set {\tt W}, \newline

\begin{myindent}
For any subset {\tt S $\subseteq$ W} of cardinality at least 2, such that for all
{\tt s $\in$ W - S}, $\neg ${\tt myPick s}, there exist at least two distinct
elements in {\tt S}, such that $\neg~\neg~${\tt myPick s}.
\end{myindent}

% \section{First Section}
% \subsection{A Subsection Sample}
% Please note that the first paragraph of a section or subsection is
% not indented. The first paragraph that follows a table, figure,
% equation etc. does not need an indent, either.
%
% Subsequent paragraphs, however, are indented.
%
% \subsubsection{Sample Heading (Third Level)} Only two levels of
% headings should be numbered. Lower level headings remain unnumbered;
% they are formatted as run-in headings.
%
% \paragraph{Sample Heading (Fourth Level)}
% The contribution should contain no more than four levels of
% headings. Table~\ref{tab1} gives a summary of all heading levels.
%
% \begin{table}
% \caption{Table captions should be placed above the
% tables.}\label{tab1}
% \begin{tabular}{|l|l|l|}
% \hline
% Heading level &  Example & Font size and style\\
% \hline
% Title (centered) &  {\Large\bfseries Lecture Notes} & 14 point, bold\\
% 1st-level heading &  {\large\bfseries 1 Introduction} & 12 point, bold\\
% 2nd-level heading & {\bfseries 2.1 Printing Area} & 10 point, bold\\
% 3rd-level heading & {\bfseries Run-in Heading in Bold.} Text follows & 10 point, bold\\
% 4th-level heading & {\itshape Lowest Level Heading.} Text follows & 10 point, italic\\
% \hline
% \end{tabular}
% \end{table}
%
%
% \noindent Displayed equations are centered and set on a separate
% line.
% \begin{equation}
% x + y = z
% \end{equation}
% Please try to avoid rasterized images for line-art diagrams and
% schemas. Whenever possible, use vector graphics instead (see
% Fig.~\ref{fig1}).
%
% \begin{figure}
% \includegraphics[width=\textwidth]{fig1.eps}
% \caption{A figure caption is always placed below the illustration.
% Please note that short captions are centered, while long ones are
% justified by the macro package automatically.} \label{fig1}
% \end{figure}
%
% \begin{theorem}
% This is a sample theorem. The run-in heading is set in bold, while
% the following text appears in italics. Definitions, lemmas,
% propositions, and corollaries are styled the same way.
% \end{theorem}
% %
% % the environments 'definition', 'lemma', 'proposition', 'corollary',
% % 'remark', and 'example' are defined in the LLNCS documentclass as well.
% %
% \begin{proof}
% Proofs, examples, and remarks have the initial word in italics,
% while the following text appears in normal font.
% \end{proof}
% For citations of references, we prefer the use of square brackets
% and consecutive numbers. Citations using labels or the author/year
% convention are also acceptable. The following bibliography provides
% a sample reference list with entries for journal
% articles~\cite{ref_article1}, an LNCS chapter~\cite{ref_lncs1}, a
% book~\cite{ref_book1}, proceedings without editors~\cite{ref_proc1},
% and a homepage~\cite{ref_url1}. Multiple citations are grouped
% \cite{ref_article1,ref_lncs1,ref_book1},
% \cite{ref_article1,ref_book1,ref_proc1,ref_url1}.

% \subsubsection{Acknowledgements} Please place your acknowledgments at
% the end of the paper, preceded by an unnumbered run-in heading (i.e.
% 3rd-level heading).
%
%
% ---- Bibliography ----
%
% BibTeX users should specify bibliography style 'splncs04'.
% References will then be sorted and formatted in the correct style.

\bibliographystyle{splncs04}
\bibliography{hanging-bib}


\end{document}
